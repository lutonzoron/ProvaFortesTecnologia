unit UNF_CadastroBomba;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.ExtCtrls, Data.DB, Vcl.DBCtrls,
  Vcl.StdCtrls, Vcl.Mask, Vcl.Grids, Vcl.DBGrids, Vcl.ComCtrls, Vcl.Buttons,
  FireDAC.Stan.Intf, FireDAC.Stan.Option, FireDAC.Stan.Param,
  FireDAC.Stan.Error, FireDAC.DatS, FireDAC.Phys.Intf, FireDAC.DApt.Intf,
  FireDAC.Stan.Async, FireDAC.DApt, FireDAC.Comp.DataSet, FireDAC.Comp.Client;

type
  TFRM_CadastroBomba = class(TForm)
    PNL_Fundo: TPanel;
    PGC_Bombas: TPageControl;
    TBS_Consulta: TTabSheet;
    DBG_Bomba: TDBGrid;
    TBS_Cadastro: TTabSheet;
    Panel1: TPanel;
    Label1: TLabel;
    DBE_Descricao: TDBEdit;
    PNL_Botoes: TPanel;
    SPB_Novo: TSpeedButton;
    SPB_Editar: TSpeedButton;
    SPB_Excluir: TSpeedButton;
    SPB_Gravar: TSpeedButton;
    SPB_Cancelar: TSpeedButton;
    SPB_Sair: TSpeedButton;
    FDQ_Combustivel: TFDQuery;
    DTS_Combustivel: TDataSource;
    FDQ_CombustivelCODIGO_ID: TIntegerField;
    FDQ_CombustivelDESCRICAO: TStringField;
    FDQ_CombustivelVALOR: TFloatField;
    Label2: TLabel;
    DBE_Valor: TDBEdit;
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure SPB_SairClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure botoes;
    procedure SPB_NovoClick(Sender: TObject);
    procedure SPB_EditarClick(Sender: TObject);
    procedure SPB_ExcluirClick(Sender: TObject);
    procedure SPB_GravarClick(Sender: TObject);
    procedure DBG_BombaDblClick(Sender: TObject);
    procedure SPB_CancelarClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FRM_CadastroBomba: TFRM_CadastroBomba;

implementation

{$R *.dfm}

uses UNF_FDQueryHelper, UNF_Funcoes, UNF_MODULO;

procedure TFRM_CadastroBomba.botoes;
begin
   SPB_Novo.Enabled       := not SPB_Novo.Enabled;
   SPB_Editar.Enabled     := not SPB_Editar.Enabled;
   SPB_Excluir.Enabled    := not SPB_Excluir.Enabled;
   SPB_Gravar.Enabled     := not SPB_Gravar.Enabled;
   SPB_Cancelar.Enabled   := not SPB_Cancelar.Enabled;
   SPB_Sair.Enabled       := not SPB_Sair.Enabled;


   TBS_Consulta.Enabled  := not TBS_Consulta.Enabled;
   DBG_Bomba.Enabled     := not DBG_Bomba.Enabled;
end;

procedure TFRM_CadastroBomba.DBG_BombaDblClick(Sender: TObject);
begin
   SPB_Editar.Click;
end;

procedure TFRM_CadastroBomba.FormClose(Sender: TObject;
  var Action: TCloseAction);
begin
   Action := caFree;
   FRM_CadastroBomba := nil;
end;

procedure TFRM_CadastroBomba.FormCreate(Sender: TObject);
begin
   PGC_Bombas.ActivePage := TBS_Consulta;
   FDQ_COMBUSTIVEL.Reopen;
end;

procedure TFRM_CadastroBomba.SPB_CancelarClick(Sender: TObject);
begin
   PGC_Bombas.ActivePage := TBS_Consulta;
   botoes;
   FDQ_Combustivel.Cancel;
end;

procedure TFRM_CadastroBomba.SPB_EditarClick(Sender: TObject);
begin
   if(FDQ_Combustivel.IsEmpty)then
   begin
      MessageBox(Handle, 'Não há combustível para editar!', 'Sistema Gerenciador de Posto', MB_ICONEXCLAMATION + MB_OK);
      exit;
   end;

   PGC_Bombas.ActivePage := TBS_Cadastro;
   botoes;
   FDQ_Combustivel.Edit;
   DBE_Descricao.SetFocus;
end;

procedure TFRM_CadastroBomba.SPB_ExcluirClick(Sender: TObject);
begin
   if(FDQ_Combustivel.IsEmpty)then
   begin
      MessageBox(Handle, 'Não há combustível para excluir!', 'Sistema Gerenciador de Posto', MB_ICONEXCLAMATION + MB_OK);
      exit;
   end;

   if(MessageDlg('Deseja realmente excluir o combustível?',mtWarning, mbOKCancel, 0) <> mrOk)then
   begin
      exit;
   end;

   FDQ_Combustivel.Delete;
end;

procedure TFRM_CadastroBomba.SPB_GravarClick(Sender: TObject);
begin
   PGC_Bombas.ActivePage := TBS_Consulta;
   botoes;

   FDQ_Combustivel.Post;
   FDQ_Combustivel.Refresh;
end;

procedure TFRM_CadastroBomba.SPB_NovoClick(Sender: TObject);
begin
   PGC_Bombas.ActivePage := TBS_Cadastro;
   botoes;
   FDQ_Combustivel.Append;
   FDQ_CombustivelCODIGO_ID.AsInteger := 0;
   DBE_Descricao.SetFocus;
end;

procedure TFRM_CadastroBomba.SPB_SairClick(Sender: TObject);
begin
   close;
end;

end.
